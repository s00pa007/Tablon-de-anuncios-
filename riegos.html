<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SuperRiegos3000</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root {
            --gb-lightest: #9bbc0f;
            --gb-light: #8bac0f;
            --gb-medium: #306230;
            --gb-dark: #0f380f;
            --border-radius: 4px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Press Start 2P', cursive;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: var(--gb-dark);
            color: var(--gb-lightest);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            font-size: 8px;
        }

        /* Header Styles */
        .header {
            height: 40px;
            min-height: 40px;
            padding: 0 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--gb-dark);
            border-bottom: 2px solid var(--gb-medium);
        }

        .header-title {
            font-size: 10px;
            color: var(--gb-lightest);
        }

        .score {
            font-size: 10px;
            color: var(--gb-lightest);
        }

        /* Monitor Styles */
        .monitor {
            height: 50vh;
            padding: 8px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            overflow-y: auto;
            background-color: var(--gb-medium);
            position: relative;
        }

        .empty-state {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            width: 100%;
            padding: 16px;
        }

        .empty-state-emoji {
            font-size: 24px;
            margin-bottom: 8px;
            filter: grayscale(1) brightness(1.5) contrast(1.2);
            mix-blend-mode: screen;
        }

        .empty-state-text {
            color: var(--gb-lightest);
            font-size: 8px;
            line-height: 1.5;
        }

        /* Irrigation Box Styles */
        .irrigation-box {
            background-color: var(--gb-light);
            border: 2px solid var(--gb-lightest);
            border-radius: var(--border-radius);
            padding: 8px;
            position: relative;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .irrigation-box.active {
            background-color: var(--gb-dark);
            color: var(--gb-lightest);
            border-color: var(--gb-light);
        }

        .irrigation-box.finished {
            opacity: 0.7;
            background-color: var(--gb-medium);
        }

        .irrigation-zone {
            font-size: 6px;
            color: var(--gb-medium);
        }

        .irrigation-box.active .irrigation-zone {
            color: var(--gb-light);
        }

        .irrigation-name {
            font-size: 8px;
            margin: 4px 0;
        }

        .irrigation-time {
            margin-top: auto;
            font-size: 10px;
        }

        .water-drops {
            position: absolute;
            top: 4px;
            right: 4px;
            font-size: 12px;
            opacity: 0;
            filter: grayscale(1) brightness(1.5) contrast(1.2);
            mix-blend-mode: screen;
        }

        .irrigation-box.active .water-drops {
            animation: dropBlink 1s step-start infinite;
        }

        @keyframes dropBlink {
            50% { opacity: 1; }
        }

        /* Menu Layout Styles */
        .menu {
            flex: 1 1 auto;
            padding: 8px;
            background-color: var(--gb-light);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .menu-columns {
            display: flex;
            height: 100%;
            gap: 8px;
        }

        .menu-left {
            width: 40%;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .menu-right {
            width: 60%;
            border-left: 2px solid var(--gb-dark);
            padding-left: 8px;
            overflow-y: auto;
        }

        /* Category Styles */
        .menu-category {
            background-color: var(--gb-dark);
            padding: 12px 8px;
            border-radius: var(--border-radius);
            text-align: center;
            color: var(--gb-lightest);
            cursor: pointer;
        }

        .menu-category.active {
            background-color: var(--gb-medium);
            border: 2px solid var(--gb-lightest);
        }

        /* Submenu Styles */
        .submenu {
            display: none;
            height: 100%;
        }

        .submenu.active {
            display: block;
        }

        .submenu-group {
            margin: 4px 0;
            border: 2px solid var(--gb-dark);
            border-radius: var(--border-radius);
            overflow: hidden;
        }

        .submenu-group-title {
            background-color: var(--gb-dark);
            color: var(--gb-lightest);
            padding: 8px;
            cursor: pointer;
        }

        .submenu-items {
            display: none;
            background-color: var(--gb-medium);
        }

        .submenu-items.active {
            display: block;
        }

        .submenu-item {
            padding: 8px;
            border-top: 1px solid var(--gb-dark);
            color: var(--gb-lightest);
            cursor: pointer;
        }

        .submenu-item:active {
            background-color: var(--gb-dark);
        }

        #menu-mano .submenu-item {
            background-color: var(--gb-dark);
            border-color: var(--gb-medium);
            margin: 2px 0;
        }

        #menu-mano .submenu-item:active {
            background-color: var(--gb-medium);
        }

        /* Footer Styles */
        .footer {
            height: 40px;
            min-height: 40px;
            padding: 0 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--gb-dark);
            border-top: 2px solid var(--gb-medium);
        }

        .footer-title {
            font-size: 10px;
            color: var(--gb-lightest);
        }

        .settings-container {
            position: relative;
        }

        .settings-button {
            background-color: var(--gb-medium);
            border: 2px solid var(--gb-lightest);
            border-radius: var(--border-radius);
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            padding: 0;
        }

        .gear-icon {
            font-size: 14px;
            filter: grayscale(1) brightness(1.5) contrast(1.2);
            mix-blend-mode: screen;
        }

        .settings-menu {
            display: none;
            position: absolute;
            bottom: 100%;
            right: 0;
            background-color: var(--gb-medium);
            border: 2px solid var(--gb-lightest);
            border-radius: var(--border-radius);
            padding: 4px;
            width: 120px;
            margin-bottom: 8px;
        }

        .settings-menu.active {
            display: block;
        }

        .settings-menu-item {
            padding: 8px;
            text-align: center;
            cursor: pointer;
            background-color: var(--gb-dark);
            color: var(--gb-lightest);
            border-radius: var(--border-radius);
            font-size: 8px;
        }

        .settings-menu-item:active {
            opacity: 0.8;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(15, 56, 15, 0.8);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: var(--gb-light);
            padding: 4px; /* Reducir padding */
            border-radius: var(--border-radius);
            border: 2px solid var(--gb-lightest);
            max-width: 80%;
            width: 220px; /* Reducir ancho */
        }

        .irrigation-controls {
            display: flex;
            flex-direction: column;
            gap: 2px; /* Reducir espacio entre botones */
        }

        .control-button, .modal-button {
            background-color: var(--gb-dark);
            border: none;
            color: var(--gb-lightest);
            padding: 4px; /* Reducir padding */
            border-radius: var(--border-radius);
            margin: 1px 0; /* Reducir margen */
            width: 100%;
            font-family: 'Press Start 2P', cursive;
            font-size: 6px; /* Reducir tama√±o de fuente */
            cursor: pointer;
        }

        .control-button:active, .modal-button:active {
            opacity: 0.8;
        }

        /* Message Popup Styles */
        .message-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: var(--gb-light);
            color: var(--gb-dark);
            padding: 12px; /* Reducir padding */
            border-radius: var(--border-radius);
            text-align: center;
            display: none;
            z-index: 2000;
            min-width: 180px; /* Reducir ancho m√≠nimo */
            border: 2px solid var(--gb-dark);
            font-size: 7px; /* Reducir tama√±o de fuente */
        }

        .message-popup.active {
            display: block;
        }

        #messageText {
            margin-bottom: 6px; /* Reducir margen */
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-title">SuperRiegos3000</div>
        <div class="score">Puntos: <span id="score">0</span></div>
    </div>

    <div class="monitor" id="monitor">
        <div class="empty-state" id="emptyState">
            <div class="empty-state-emoji">üå¥</div>
            <div class="empty-state-text">No hay riegos activos</div>
        </div>
    </div>

    <div class="menu">
        <div class="menu-columns">
            <div class="menu-left">
                <div class="menu-category" data-category="superior">Parte Superior</div>
                <div class="menu-category" data-category="inferior">Parte Inferior</div>
                <div class="menu-category" data-category="mano">A Mano</div>
            </div>
            <div class="menu-right">
                <div class="submenu" id="menu-superior"></div>
                <div class="submenu" id="menu-inferior"></div>
                <div class="submenu" id="menu-mano"></div>
            </div>
        </div>
    </div>

    <div class="footer">
        <div class="footer-title">SuperRiegos3000</div>
        <div class="settings-container">
            <button class="settings-button" id="settingsButton">
                <div class="gear-icon">‚öôÔ∏è</div>
            </button>
            <div class="settings-menu" id="settingsMenu">
                <div class="settings-menu-item" id="resetButton">Resetear Todo</div>
            </div>
        </div>
    </div>

    <!-- Irrigation Control Modal -->
    <div class="modal" id="irrigationModal">
        <div class="modal-content">
            <div class="irrigation-controls">
                <button class="control-button" id="startButton">Encender</button>
                <button class="control-button" id="stopButton">Apagar</button>
                <button class="control-button" id="pauseButton">Pausar</button>
                <button class="control-button" id="customizeButton">Definir</button>
            </div>
        </div>
    </div>

    <!-- Message Popup -->
    <div class="message-popup" id="messagePopup">
        <div id="messageText"></div>
        <button class="modal-button" id="closeMessageButton">OK</button> <!-- Cambiado a 'OK' -->
    </div>
   

<script>
// Control de inicializaci√≥n de event listeners
let eventListenersInitialized = false;

// Game state
const gameState = {
    irrigations: {},
    score: 0,
    activeCategory: null,
    activeGroups: new Set(),
    settingsMenuOpen: false
};

// Configuraci√≥n de riegos
const irrigationConfig = {
    superior: {
        groups: {
            'Musical': {
                name: 'Musical',
                items: {
                    'Riego 1': 30 * 60,
                    'Riego 2': 30 * 60,
                    'Frutal': 30 * 60
                }
            },
            'Patos': {
                name: 'Patos',
                items: {
                    'Riego 1': 30 * 60,
                    'Riego 2 y 3': 30 * 60,
                    'Difusores': 15 * 60
                }
            }
        }
    },
    inferior: {
        groups: {
            'Arriba': {
                name: 'Arriba',
                items: {
                    'Parque Infantil': 30 * 60,
                    'Minigolf': 30 * 60,
                    'Petanca': 30 * 60,
                    'Talud': 30 * 60
                }
            },
            'Abajo': {
                name: 'Abajo',
                items: {
                    'Cancha de Tenis': 30 * 60
                }
            },
            'Aguacatero': {
                name: 'Aguacatero',
                items: {
                    'Aguacatero 1': 30 * 60,
                    'Aguacatero 2': 30 * 60,
                    'Aguacatero 3': 30 * 60
                }
            }
        }
    },
    mano: {
        items: ['Punta del Barco', 'Cactus', 'Rejilla', 'Rotonda'],
        times: {
            'Punta del Barco': 20 * 60,
            'Cactus': 20 * 60,
            'Rejilla': 20 * 60,
            'Rotonda': 80 * 60  // 1 hora 20 minutos
        }
    }
};

// Initialize game
function initGame() {
    loadGameState();
    setupEventListeners();
    renderIrrigationBoxes();
    updateScore();
    startGameLoop();
}

// Load game state
function loadGameState() {
    const savedState = localStorage.getItem('superRiegos3000State');
    if (savedState) {
        const parsed = JSON.parse(savedState);
        gameState.irrigations = parsed.irrigations || {};
        gameState.score = parsed.score || 0;
        gameState.activeCategory = null;
        gameState.activeGroups = new Set(parsed.activeGroups || []);
    }
}

// Save game state
function saveGameState() {
    localStorage.setItem('superRiegos3000State', JSON.stringify({
        irrigations: gameState.irrigations,
        score: gameState.score,
        activeGroups: Array.from(gameState.activeGroups)
    }));
}

// Setup event listeners (una sola vez)
function setupEventListeners() {
    if (eventListenersInitialized) return;
    
    document.querySelectorAll('.menu-category').forEach(category => {
        category.addEventListener('click', () => toggleCategory(category.dataset.category));
    });
    
    document.getElementById('settingsButton').addEventListener('click', toggleSettingsMenu);
    document.getElementById('resetButton').addEventListener('click', resetGame);
    document.getElementById('startButton').addEventListener('click', startIrrigation);
    document.getElementById('stopButton').addEventListener('click', stopIrrigation);
    document.getElementById('pauseButton').addEventListener('click', pauseIrrigation);
    document.getElementById('customizeButton').addEventListener('click', customizeIrrigation);
    document.getElementById('closeMessageButton').addEventListener('click', hideMessage);
    
    // Close modals when clicking outside
    document.addEventListener('click', (e) => {
        const settingsButton = document.getElementById('settingsButton');
        const settingsMenu = document.getElementById('settingsMenu');
        
        if (!settingsButton.contains(e.target) && !settingsMenu.contains(e.target)) {
            settingsMenu.classList.remove('active');
            gameState.settingsMenuOpen = false;
        }
        
        if (e.target.classList.contains('modal')) {
            e.target.classList.remove('active');
        }
    });
    
    eventListenersInitialized = true;
}

// Toggle settings menu
function toggleSettingsMenu(event) {
    event.stopPropagation();
    const settingsMenu = document.getElementById('settingsMenu');
    gameState.settingsMenuOpen = !gameState.settingsMenuOpen;
    settingsMenu.classList.toggle('active', gameState.settingsMenuOpen);
}

// Toggle category
function toggleCategory(category) {
    const allCategories = document.querySelectorAll('.menu-category');
    const allSubmenus = document.querySelectorAll('.submenu');
    const selectedCategory = document.querySelector(`.menu-category[data-category="${category}"]`);
    const submenu = document.getElementById(`menu-${category}`);
    
    allCategories.forEach(cat => cat.classList.remove('active'));
    allSubmenus.forEach(sub => sub.classList.remove('active'));
    
    if (gameState.activeCategory === category) {
        gameState.activeCategory = null;
    } else {
        selectedCategory.classList.add('active');
        submenu.classList.add('active');
        gameState.activeCategory = category;
        renderSubmenuItems(category);
    }
}

// Toggle group
function toggleGroup(groupName) {
    const items = document.querySelector(`.submenu-group[data-group="${groupName}"] .submenu-items`);
    if (gameState.activeGroups.has(groupName)) {
        gameState.activeGroups.delete(groupName);
        items.classList.remove('active');
    } else {
        gameState.activeGroups.add(groupName);
        items.classList.add('active');
    }
    saveGameState();
}

// Render submenu items
function renderSubmenuItems(category) {
    const submenu = document.getElementById(`menu-${category}`);
    submenu.innerHTML = '';
    
    if (category === 'mano') {
        irrigationConfig[category].items.forEach(item => {
            const div = document.createElement('div');
            div.className = 'submenu-item';
            div.textContent = item;
            div.addEventListener('click', () => startNewIrrigation(item));
            submenu.appendChild(div);
        });
    } else {
        Object.entries(irrigationConfig[category].groups).forEach(([groupName, group]) => {
            const groupDiv = document.createElement('div');
            groupDiv.className = 'submenu-group';
            groupDiv.dataset.group = groupName;
            
            const titleDiv = document.createElement('div');
            titleDiv.className = 'submenu-group-title';
            titleDiv.textContent = groupName;
            titleDiv.addEventListener('click', () => toggleGroup(groupName));
            groupDiv.appendChild(titleDiv);
            
            const itemsDiv = document.createElement('div');
            itemsDiv.className = 'submenu-items';
            if (gameState.activeGroups.has(groupName)) {
                itemsDiv.classList.add('active');
            }
            
            Object.entries(group.items).forEach(([itemName, time]) => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'submenu-item';
                itemDiv.textContent = itemName;
                itemDiv.addEventListener('click', () => startNewIrrigation(itemName));
                itemsDiv.appendChild(itemDiv);
            });
            
            groupDiv.appendChild(itemsDiv);
            submenu.appendChild(groupDiv);
        });
    }
}

// Get parent zone
function getParentZone(name) {
    if (irrigationConfig.mano.times[name]) {
        return 'A Mano';
    }
    
    for (const category of ['superior', 'inferior']) {
        for (const [groupName, group] of Object.entries(irrigationConfig[category].groups)) {
            if (group.items && group.items[name] !== undefined) {
                return groupName;
            }
        }
    }
    return '';
}

// Render irrigation boxes
function renderIrrigationBoxes() {
    const monitor = document.getElementById('monitor');
    
    // Eliminar cajas de riego existentes
    const boxes = monitor.querySelectorAll('.irrigation-box');
    boxes.forEach(box => monitor.removeChild(box));
    
    // A√±adir las cajas de riego
    Object.entries(gameState.irrigations).forEach(([name, irrigation]) => {
        const box = createIrrigationBox(name, irrigation);
        monitor.appendChild(box);
    });
    
    // Actualizar visibilidad del estado vac√≠o
    const emptyState = document.getElementById('emptyState');
    const hasIrrigations = Object.keys(gameState.irrigations).length > 0;
    emptyState.style.display = hasIrrigations ? 'none' : 'block';
}

// Create irrigation box
function createIrrigationBox(name, irrigation) {
    const box = document.createElement('div');
    box.className = 'irrigation-box';
    if (irrigation.active) {
        box.classList.add('active');
    }
    if (irrigation.timeLeft <= 0) {
        box.classList.add('finished');
    }
    
    const zone = document.createElement('div');
    zone.className = 'irrigation-zone';
    zone.textContent = getParentZone(name);
    box.appendChild(zone);
    
    const nameElement = document.createElement('div');
    nameElement.className = 'irrigation-name';
    nameElement.textContent = name;
    box.appendChild(nameElement);
    
    const timeElement = document.createElement('div');
    timeElement.className = 'irrigation-time';
    timeElement.textContent = formatTime(Math.abs(irrigation.timeLeft));
    if (irrigation.timeLeft <= 0) {
        timeElement.textContent = '‚è≥ +' + timeElement.textContent;
    }
    box.appendChild(timeElement);
    
    const waterDrops = document.createElement('div');
    waterDrops.className = 'water-drops';
    waterDrops.textContent = 'üíß';
    box.appendChild(waterDrops);
    
    box.addEventListener('click', () => showIrrigationModal(name));
    return box;
}

// Format time display
function formatTime(seconds) {
    const hours = Math.floor(seconds / 3600);
    const minutes = Math.floor((seconds % 3600) / 60);
    const secs = seconds % 60;
    return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
}

// Show/hide modals and messages
function showIrrigationModal(name) {
    const modal = document.getElementById('irrigationModal');
    modal.dataset.irrigationName = name;
    modal.classList.add('active');
}

function hideIrrigationModal() {
    document.getElementById('irrigationModal').classList.remove('active');
}

function showMessage(text) {
    const popup = document.getElementById('messagePopup');
    document.getElementById('messageText').textContent = text;
    popup.classList.add('active');
    setTimeout(hideMessage, 3000);
}

function hideMessage() {
    document.getElementById('messagePopup').classList.remove('active');
}

// Irrigation control functions
function startIrrigation() {
    const modal = document.getElementById('irrigationModal');
    const name = modal.dataset.irrigationName;
    const irrigation = gameState.irrigations[name];
    
    if (irrigation && !irrigation.active) {
        irrigation.active = true;
        irrigation.paused = false;
        irrigation.startTime = Date.now();
        saveGameState();
        renderIrrigationBoxes();
        showMessage('¬°Riego encendido!');
    }
    hideIrrigationModal();
}

function stopIrrigation() {
    const modal = document.getElementById('irrigationModal');
    const name = modal.dataset.irrigationName;
    const irrigation = gameState.irrigations[name];
    
    if (irrigation && (irrigation.active || irrigation.paused)) {
        irrigation.active = false;
        irrigation.paused = false;
        irrigation.startTime = null;
        showMessage('Riego apagado');
        saveGameState();
        renderIrrigationBoxes();
    }
    hideIrrigationModal();
}

function pauseIrrigation() {
    const modal = document.getElementById('irrigationModal');
    const name = modal.dataset.irrigationName;
    const irrigation = gameState.irrigations[name];
    
    if (irrigation && irrigation.active && !irrigation.paused) {
        irrigation.paused = true;
        irrigation.active = false;
        irrigation.pausedTimeLeft = irrigation.timeLeft;
        showMessage('Riego pausado');
        saveGameState();
        renderIrrigationBoxes();
    }
    hideIrrigationModal();
}

function customizeIrrigation() {
    const modal = document.getElementById('irrigationModal');
    const name = modal.dataset.irrigationName;
    const currentTime = Math.ceil(gameState.irrigations[name]?.timeLeft / 60) || 30;
    const time = prompt('Ingrese el tiempo en minutos:', currentTime);
    
    if (time && !isNaN(time)) {
        const irrigation = gameState.irrigations[name];
        if (irrigation) {
            irrigation.timeLeft = parseInt(time) * 60;
            irrigation.active = false;
            irrigation.paused = false;
            irrigation.startTime = null;
            saveGameState();
            renderIrrigationBoxes();
            showMessage('Tiempo personalizado configurado');
        }
    }
    hideIrrigationModal();
}

// Start new irrigation
function startNewIrrigation(name) {
    if (gameState.irrigations[name]) {
        showIrrigationModal(name);
        return;
    }
    
    gameState.irrigations[name] = {
        active: false,
        paused: false,
        timeLeft: getDefaultTime(name),
        startTime: null
    };
    
    saveGameState();
    renderIrrigationBoxes();
    showIrrigationModal(name);
}

function getDefaultTime(name) {
    if (irrigationConfig.mano.times[name]) {
        return irrigationConfig.mano.times[name];
    }
    
    for (const category of ['superior', 'inferior']) {
        for (const [groupName, group] of Object.entries(irrigationConfig[category].groups)) {
            if (group.items[name] !== undefined) {
                return group.items[name];
            }
        }
    }
    
    return 30 * 60; // Default: 30 minutes
}

// Score functions
function addScore(points) {
    gameState.score += points;
    updateScore();
    saveGameState();
}

function updateScore() {
    document.getElementById('score').textContent = gameState.score;
}

// Reset game
function resetGame() {
    if (confirm('¬øEst√°s seguro de que quieres reiniciar todo el sistema?')) {
        gameState.irrigations = {};
        gameState.score = 0;
        gameState.activeCategory = null;
        gameState.activeGroups.clear();
        gameState.settingsMenuOpen = false;
        document.getElementById('settingsMenu').classList.remove('active');
        // Remove active classes from menu categories and submenus
        document.querySelectorAll('.menu-category').forEach(cat => cat.classList.remove('active'));
        document.querySelectorAll('.submenu').forEach(sub => sub.classList.remove('active'));
        document.querySelectorAll('.submenu-items').forEach(item => item.classList.remove('active'));
        saveGameState();
        renderIrrigationBoxes();
        updateScore();
        showMessage('¬°Sistema reiniciado!');
    }
}

// Game loop
function startGameLoop() {
    setInterval(updateGame, 1000);
}

// Update game state
function updateGame() {
    let updated = false;
    
    Object.entries(gameState.irrigations).forEach(([name, irrigation]) => {
        if (irrigation.active) {
            if (irrigation.timeLeft > 0) {
                irrigation.timeLeft--;
                if (irrigation.timeLeft === 300) { // 5 minutes warning
                    showMessage(`¬°5 minutos restantes en ${name}!`);
                }
                updated = true;
            } else if (irrigation.timeLeft === 0) {
                showMessage(`¬°Riego completado en ${name}!`);
                irrigation.timeLeft = -1;
                updated = true;
            } else {
                irrigation.timeLeft--;
                updated = true;
            }
        } else if (irrigation.paused) {
            // Do nothing, irrigation is paused
        }
    });
    
    if (updated) {
        saveGameState();
        renderIrrigationBoxes();
    }
}

// Initialize game when page loads
window.addEventListener('load', initGame);
</script>
</body>
</html>